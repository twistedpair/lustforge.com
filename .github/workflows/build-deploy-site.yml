name: Build and Deploy Blog

on:
  push:
    branches:
      - master
      - enable-auto-deploy-action # TODO remove

jobs:
  build-deploy:
    runs-on: ubuntu-18.04
    steps:
    # Can't get the default GH Actions checkout action + submodules:true to work
    - uses: textbook/git-checkout-submodule-action@master
      with:
        args: 'git submodule update --init --recursive'

    - name: Setup Hugo
      uses: peaceiris/actions-hugo@v2.3.0
      with:
        hugo-version: '0.59.1'
        extended: true

    - name: Build Site
      run: hugo --minify -v -d docs/
