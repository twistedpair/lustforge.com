<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>AWS Command Line Password Reset &middot; Joseph Lust</title>
        <meta name="description" content="drive to develop">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.16-DEV" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="https://lust.dev/favicon.png">
        <link rel="stylesheet" href="https://lust.dev/css/normalize.css">
	<link rel="stylesheet" href="https://lust.dev/css/highlight/obsidian.css">
        <link rel="stylesheet" href="https://lust.dev/css/style.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        
        

            
            <meta property="og:type"   content="article" />
            <meta property="og:url"    content="https://lust.dev/2016/07/08/aws-cli-password-reset/" />
            <meta property="og:title"  content="AWS Command Line Password Reset" />

            <meta name="twitter:domain" value="lustforge.com" />
            <meta name="twitter:card" content="summary_large_image" />
            <meta name="twitter:title" value="AWS Command Line Password Reset" />
            
             <meta name="twitter:description" value="Your AWS login expired. Time to call the sysamdin, or can you solo this one?"/>
            

            
            <meta name="twitter:url" value="https://lust.dev/2016/07/08/aws-cli-password-reset/"/>

            
            <meta property="og:image"  content="https://lust.dev/img/aws_cli_access_denied.png">
            <meta property="twitter:image"  content="https://lust.dev/img/aws_cli_access_denied.png">
            
        
        
    </head>
    <body>
        
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17498476-1', 'auto');
ga('send', 'pageview');
</script>


        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="lust.dev" href="https://lust.dev/">lust.dev</a>
                            </h1>
                        
			
                        	<a class="button-square" href="https://lust.dev/index.xml"><i title="RSS Feed" class="fa fa-rss"></i></a>
			
                        
                            <a class="button-square button-social hint--top" data-hint="Twitter" title="Twitter" href="https://twitter.com/lustcoder">
                                <i class="fa fa-twitter"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/twistedpair">
                                <i class="fa fa-github-alt"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Stack Overflow" title="Stack Overflow" href="https://stackoverflow.com/users/564157/joseph-lust">
                                <i class="fa fa-stack-overflow"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="LinkedIn" title="LinkedIn" href="https://www.linkedin.com/in/josephlust">
                                <i class="fa fa-linkedin"></i>
                            </a>
                        
                        
			
			<h1 class="site-title" style="margin-left:10px;">
                            <a class="site-title" data-hint="Lust" title="Meet the groundskeeper" href="https://lust.dev/about/">J. Lust &#8250;</a>
                        </h1>
                    </div>

                    <ul class="site-nav">
                        
                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container">
        <header class="post-header">
    <h1 class="post-title">AWS Command Line Password Reset</h1>
    
</header>

        
<div class="post-content clearfix">

        
    
    
    <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "articleSection" : "post",
        "name" : "AWS Command Line Password Reset",
        "headline" : "AWS Command Line Password Reset",
        "description" : "Oh, Nuts Your AWS console login just expired, as the login prompt has been warning for weeks. You need to update that Route 53 entry and your boss is waiting. Do you call the sysadmin and beg for a reset, or can you solve this yourself? AWS CLI To the Rescue No worries, you\x26rsquo;ve got this covered in 15 seconds. Use the iam API call update-login-profile1 combined with your aws iam username (login name for the AWS Console Login).",
        "inLanguage" : "en-US",
        "author" : "Joseph Lust",
        "creator" : "Joseph Lust",
        "accountablePerson" : "Joseph Lust",
        "copyrightHolder" : "Joseph Lust",
        "copyrightYear" : "2016",
        "datePublished" : "",
        "publisher": "LustForge.com",
        "logo": "https:\/\/lust.dev\/favicon.png",
        "url" : "https:\/\/lust.dev\/2016\/07\/08\/aws-cli-password-reset\/",
        "wordCount" : "238",
        "image" : "https:\/\/lust.dev\/img\/aws_cli_access_denied.png",
        "keywords" : [ "aws, iam, awscli" ]
    }
    </script>
    
    


<div itemscope itemtype="http://schema.org/BlogPosting" style="display:none;">
     <meta itemprop="mainEntityOfPage" content="https://lust.dev/2016/07/08/aws-cli-password-reset/" />
     <meta itemprop="inLanguage" content="en-US" />
     <h1 itemprop="headline">AWS Command Line Password Reset</h1>
     <meta itemprop="name" content="AWS Command Line Password Reset" />
     <meta itemprop="description" content="Your AWS login expired. Time to call the sysamdin, or can you solo this one?" />
     <meta itemprop="wordCount" content="238" />
     <meta itemprop="keywords" content="aws,iam,awscli" />
     
     <meta itemprop="copyrightYear" content="2016" />
    <div itemprop="copyrightHolder" itemscope itemtype="http://schema.org/Person">
        <meta itemprop="name" content="Joseph Lust">
    </div>
    
    
     <div itemprop="image" itemscope itemtype="http://schema.org/ImageObject">
         <img  itemprop="url" src="https://lust.dev/img/aws_cli_access_denied.png" alt="thumbnail">
         <meta itemprop="width" content="220" >
         <meta itemprop="height" content="220" >
    </div>
    
    <meta itemprop="datePublished" content="2016-07-08">
    <meta itemprop="dateModified" content="2016-07-08">
    <a itemprop="mainEntityOfPage" href="/ArticleLink"></a>
    <div itemprop="author" itemscope itemtype="http://schema.org/Person">
        <meta itemprop="name" content="Joseph Lust">
    </div>
    <div itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lust.dev">
      <a itemprop="url" href="/"> 
      <span itemprop="logo" itemscope itemtype="http://schema.org/ImageObject"  >
      <img itemprop="image" src="https://lust.dev/favicon.png" />
      <link itemprop="url" href="https://lust.dev/favicon.png" />
      </span>
      </a>
    </div>
</div>

    

    

<h1 id="oh-nuts:5efceb1a28e3916f5b9c11396608079c">Oh, Nuts</h1>

<p>Your AWS console login just expired, as the login prompt <em>has been warning for weeks</em>. You need to update that Route 53 entry and your boss is waiting. Do you call the sysadmin and beg for a reset, or can you solve this yourself?</p>

<h1 id="aws-cli-to-the-rescue:5efceb1a28e3916f5b9c11396608079c">AWS CLI To the Rescue</h1>

<p>No worries, you&rsquo;ve got this covered in 15 seconds.</p>

<p>Use the iam API call <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/update-login-profile.html">update-login-profile</a><sup class="footnote-ref" id="fnref:5efceb1a28e3916f5b9c11396608079c:2"><a rel="footnote" href="#fn:5efceb1a28e3916f5b9c11396608079c:2">1</a></sup> combined with your aws iam username (login name for the <a href="https://console.aws.amazon.com/">AWS Console Login</a>).</p>

<pre><code class="language-bash">aws iam update-login-profile --user-name jsmith --password sesame --password-reset-required
</code></pre>

<p>The combination is cracked. Login. Whistle innocently like this never happened.</p>

<h1 id="other-dead-ends:5efceb1a28e3916f5b9c11396608079c">Other Dead Ends</h1>

<p>The awscli has another tempting, but misleading API called <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/change-password.html">change-password</a>.</p>

<p>If you tried it, you&rsquo;d be saddened to see the required <code>--old-password</code> parameter. This is a red herring. Dodge left.</p>

<h1 id="you-don-t-have-aws-cli-password-reset-access:5efceb1a28e3916f5b9c11396608079c">You Don&rsquo;t Have AWS CLI Password Reset Access</h1>

<p>We got a problem here. Your choices are:</p>

<ul>
<li>Kowtow to your sysadmin for mercy</li>
<li>If it&rsquo;s a root account, use the <a href="https://www.amazon.com/ap/forgotpassword?openid.pape.preferred_auth_policies=MultifactorPhysical&amp;openid.pape.max_auth_age=0&amp;openid.return_to=https%3A%2F%2Fsignin.aws.amazon.com%2Foauth%3Fresponse_type%3Dcode%26client_id%3Darn%253Aaws%253Aiam%253A%253A015428540659%253Auser%252Fhomepage%26redirect_uri%3Dhttps%253A%252F%252Fconsole.aws.amazon.com%252Fconsole%252Fhome%253Fstate%253DhashArgs%252523%2526isauthcode%253Dtrue%26noAuthCookie%3Dtrue&amp;prevRID=14XBRCDW9RJD7GXZ9KTP&amp;openid.identity=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select&amp;openid.assoc_handle=aws&amp;openid.mode=checkid_setup&amp;openid.ns.pape=http%3A%2F%2Fspecs.openid.net%2Fextensions%2Fpape%2F1.0&amp;openid.claimed_id=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select&amp;pageId=aws.ssop&amp;openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0">password reset process</a> to get a reset email<sup class="footnote-ref" id="fnref:5efceb1a28e3916f5b9c11396608079c:1"><a rel="footnote" href="#fn:5efceb1a28e3916f5b9c11396608079c:1">2</a></sup></li>
</ul>

<h1 id="allow-users-to-reset-passwords:5efceb1a28e3916f5b9c11396608079c">Allow Users to Reset Passwords</h1>

<p>If you&rsquo;re a sysadmin, set the following IAM policy to enable self service user password reset.</p>

<pre><code class="language-json">{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Sid&quot;: &quot;Stmt1500731194000&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;iam:UpdateLoginProfile&quot;
            ],
            &quot;Resource&quot;: [
                &quot;arn:aws:iam::1234567890:user/favorite_user&quot;
            ]
        }
    ]
}
</code></pre>
<div class="footnotes">

<hr />

<ol>
<li id="fn:5efceb1a28e3916f5b9c11396608079c:2">Password reset requires <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_UpdateLoginProfile.html">UpdateLoginProfile</a> IAM policy action, included in Admin role.
 <a class="footnote-return" href="#fnref:5efceb1a28e3916f5b9c11396608079c:2"><sup>[return]</sup></a></li>
<li id="fn:5efceb1a28e3916f5b9c11396608079c:1">This email will be sent to the root account email only. You&rsquo;ve got access, right?
 <a class="footnote-return" href="#fnref:5efceb1a28e3916f5b9c11396608079c:1"><sup>[return]</sup></a></li>
</ol>
</div>

</div>

	
    <div class="comments">
        <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'lustforge';
    var disqus_identifier = 'https:\/\/lust.dev\/2016\/07\/08\/aws-cli-password-reset\/';
    var disqus_title = 'AWS Command Line Password Reset';
    var disqus_url = 'https:\/\/lust.dev\/2016\/07\/08\/aws-cli-password-reset\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>


        <footer class="post-footer clearfix">
    
        <p class="post-tags">
            <span>Tagged:</span>
            
                 <a href="/tags/aws/">aws</a>
            
                 <a href="/tags/iam/">iam</a>
            
                 <a href="/tags/awscli/">awscli</a>
            
	    <a href="/tags/">[all]</a>
        </p>
    

    <div class="share">
        <a class="icon-twitter" href="https://twitter.com/share?text=AWS%20Command%20Line%20Password%20Reset&url=https%3a%2f%2flust.dev%2f2016%2f07%2f08%2faws-cli-password-reset%2f"
            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fa fa-twitter"></i>
            <span class="hidden">Twitter</span>
        </a>

        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2flust.dev%2f2016%2f07%2f08%2faws-cli-password-reset%2f"
            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <i class="fa fa-facebook"></i>
            <span class="hidden">Facebook</span>
        </a>

        <a class="icon-google-plus" href="https://plus.google.com/share?url=https%3a%2f%2flust.dev%2f2016%2f07%2f08%2faws-cli-password-reset%2f"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
           <i class="fa fa-google-plus"></i>
            <span class="hidden">Google+</span>
        </a>
    </div>
</footer>

    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a title="lust.dev" href="https://lust.dev/">lust.dev</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#">
                        <i class="fa fa-angle-up"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2009 - 2018 / Powered by <a href="http://gohugo.io/">Hugo</a></span>
                </p>
                <p class="footer-copyright">
                    <span><a href="https://github.com/twistedpair/ghostwriter">Lustwriter theme</a> By J. Lust</span>
                    <span>/ Forked from <a href="https://github.com/jbub/ghostwriter">Ghostwriter</a></span>
                </p>
            </div>
        </footer>

        <script src="https://lust.dev/js/jquery-1.11.3.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
        <script src="https://lust.dev/js/jquery.fitvids.js"></script>
        <script src="https://lust.dev/js/scripts.js"></script>
    </body>
</html>

