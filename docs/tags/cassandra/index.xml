<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Cassandra on lust.dev</title>
    <link>https://lust.dev/tags/cassandra/</link>
    <description>Recent content in Cassandra on lust.dev</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Joseph Lust</copyright>
    <lastBuildDate>Mon, 22 Jun 2015 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://lust.dev/tags/cassandra/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Cassandra Errors: The UnSet Upsert</title>
      <link>https://lust.dev/2015/06/22/cassandra-errors-the-unset-upsert/</link>
      <pubDate>Mon, 22 Jun 2015 00:00:00 +0000</pubDate>
      
      <guid>https://lust.dev/2015/06/22/cassandra-errors-the-unset-upsert/</guid>
      <description>&lt;p&gt;During a late night coding session I got the following trace from the Datastax Cassandra Java Driver:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;com.datastax.driver.core.exceptions.SyntaxError: line 1:36 mismatched input &#39;WHERE&#39; expecting K_SET (UPDATE my_table [WHERE] id...)
at com.datastax.driver.core.Responses$Error.asException(Responses.java:101) ~[cassandra-driver-core-2.1.5.jar:na]
at com.datastax.driver.core.DefaultResultSetFuture.onSet(DefaultResultSetFuture.java:140) ~[cassandra-driver-core-2.1.5.jar:na]
at com.datastax.driver.core.RequestHandler.setFinalResult(RequestHandler.java:293) ~[cassandra-driver-core-2.1.5.jar:na]
at com.datastax.driver.core.RequestHandler.onSet(RequestHandler.java:455) ~[cassandra-driver-core-2.1.5.jar:na]
at com.datastax.driver.core.Connection$Dispatcher.messageReceived(Connection.java:734) ~[cassandra-driver-core-2.1.5.jar:na]
at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70) ~[netty-3.10.1.Final.jar:na]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Ok. Let&amp;#8217;s think it through:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Did we not put a key column in the &lt;code&gt;WHERE&lt;/code&gt; clause? Nope.&lt;/li&gt;
&lt;li&gt;Did we put a non-key column in the &lt;code&gt;WHERE&lt;/code&gt; clause? Nope.&lt;/li&gt;
&lt;li&gt;Did we put a key column in the &lt;code&gt;SET&lt;/code&gt; clause? Nope.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;OK, what then?&lt;/p&gt;

&lt;p&gt;Well&amp;#8230; my code has many &lt;code&gt;setIfNonNull(...)&lt;/code&gt; helpers. Turns out my testing dataset had all &lt;code&gt;NULL&lt;/code&gt;s. Thus, nothing was being set! Obviously an &lt;code&gt;UPDATE&lt;/code&gt; must update something (though the lines are blurred in C* Upsert land).&lt;/p&gt;

&lt;p&gt;So, this cryptic message from C* should really read &lt;strong&gt;&amp;#8220;Update statement missing SET clause, you fool.&amp;#8221;&lt;/strong&gt; Now if I could &lt;a href=&#34;https://github.com/apache/cassandra/search?utf8=%E2%9C%93&amp;q=mismatched&#34; target=&#34;_blank&#34;&gt;find it in the source&lt;/a&gt;, I&amp;#8217;d submit a PR.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>