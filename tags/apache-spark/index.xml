<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Apache Spark on lust.dev</title><link>https://lust.dev/tags/apache-spark/</link><description>Recent content in Apache Spark on lust.dev</description><generator>Hugo</generator><language>en-us</language><copyright>Joe Lust</copyright><lastBuildDate>Thu, 07 Jan 2016 00:00:00 +0000</lastBuildDate><atom:link href="https://lust.dev/tags/apache-spark/index.xml" rel="self" type="application/rss+xml"/><item><title>Home Cooked Apache Spark</title><link>https://lust.dev/2016/01/07/home-cooked-apache-spark/</link><pubDate>Thu, 07 Jan 2016 00:00:00 +0000</pubDate><guid>https://lust.dev/2016/01/07/home-cooked-apache-spark/</guid><description>&lt;p&gt;We use Apache Spark for various applications at &lt;a href="https://mc10inc.com"&gt;my job&lt;/a&gt;, but Spark is still relatively unstable, as evidenced by the project&amp;rsquo;s &lt;a href="https://github.com/apache/spark/pulls"&gt;11K+&lt;/a&gt; pull requests. To maintain developer velocity, we regularly patch show stopper bugs in the Spark source. The process is simple.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Install JDK 6, which is required for PySpark (or you&amp;rsquo;ll get a lengthy warning). Use the &lt;code&gt;oracle-java8-set-default&lt;/code&gt; package to switch between Java 6 and 8, or set &lt;code&gt;JAVA_HOME&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo apt-get install oracle-java6-installer
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;oracle-java8-set-default &lt;span class="c1"&gt;# Go back to Java 8 when you&amp;#39;re done building&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Fork the &lt;a href="https://github.com/apache/spark"&gt;Apache Spark repo&lt;/a&gt; so you can submit a Pull Request later&lt;/p&gt;</description></item><item><title>Remote Debugging Apache Spark Clusters</title><link>https://lust.dev/2016/01/01/remote-debugging-apache-spark-clusters/</link><pubDate>Fri, 01 Jan 2016 00:00:00 +0000</pubDate><guid>https://lust.dev/2016/01/01/remote-debugging-apache-spark-clusters/</guid><description>&lt;p&gt;Debugging Apache Spark can be tricky. Sure, everything works on your &lt;code&gt;--master local[4]&lt;/code&gt; cluster, but not when run on a real cluster. In these cases, you need to drop to a debug breakpoint in the running cluster.&lt;/p&gt;
&lt;h1 id="get-debugger-listening"&gt;Get Debugger Listening&lt;/h1&gt;
&lt;p&gt;Simply update the launch args wherever you start Spark like so. Note: &lt;code&gt;SPARK_JAVA_OPTS&lt;/code&gt; won&amp;rsquo;t do the trick.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;SPARK_WORKER_OPTS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;-Xdebug -Xrunjdwp:server=y,transport=dt_socket,address=4000,suspend=n&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;SPARK_MASTER_OPTS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;-Xdebug -Xrunjdwp:server=y,transport=dt_socket,address=4000,suspend=n&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; /opt/spark/sbin/start-master.sh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Open an SSH tunnel to your remote cluster machine, mapping &lt;code&gt;localhost:4000&lt;/code&gt; to &lt;code&gt;spark-master.foo.com:5000&lt;/code&gt;, assuming the cluster is at &lt;code&gt;spark-master.foo.com&lt;/code&gt;, listening on port &lt;code&gt;5000&lt;/code&gt;.&lt;/p&gt;</description></item></channel></rss>